<!DOCTYPE html>
<html>
<head>
    <title>Combination Finder (beta)</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
    <style>
        .result-output {
            font-size: 1.5em; /* Adjust the size as needed */
            width: 100%;
            border-collapse: collapse; /* For a cleaner table look */
        }
        .result-output th, .result-output td {
            border: 1px solid #ddd; /* Add border to cells */
            padding: 8px; /* Add padding for cell content */
            text-align: left; /* Align text to the left */
        }
        .result-output th {
            background-color: #f2f2f2; /* Light background for header */
            font-weight: bold; /* Bold text for header */
        }
    </style>
</head>
<body>
    <h1>Combination Finder (beta)</h1>

    <form action="/process" method="post">
        <label for="dataset1">Large Values (target):</label><br>
        <span>[RECOMMEND Maximum: 5 values]</span>
        <span>Current Count: <span id="count1">0</span></span><br>
        <div class="container">
            <textarea class="numbered-textarea" id="dataset1" name="dataset1" rows="5" cols="60" oninput="updateCount('dataset1', 'count1')"></textarea>
        </div>
        <br><br>

        <label for="dataset2">Smaller Values:</label><br>
        <span>[RECOMMEND Maximum: 20 values]</span>
        <span>     Current Count: <span id="count2">0</span></span><br>
        <div class="container">
            <textarea class="numbered-textarea" id="dataset2" name="dataset2" rows="20" cols="60" oninput="updateCount('dataset2', 'count2')"></textarea>
        </div>
        <br><br>

        <input type="submit" value="Find Combinations">
    </form>

    {% if results %}
    <h2>Results:</h2>
    <table class="result-output">
        <thead>
            <tr>
                <th>Large Value (Target)</th>
                <th>Combination</th>
            </tr>
        </thead>
        <tbody>
            {% for key, value in results['dataset2_to_dataset1'].items() %}
                <tr>
                    <td>{{ "{:,}".format(key) }}</td> <!-- Format large value with commas -->
                    <td>
                        {% if value != "No match" %}
                            <table>
                                <tr>
                                    {% for num in value %}
                                        <td>{{ "{:,}".format(num) }}</td> <!-- Format combination values with commas -->
                                    {% endfor %}
                                </tr>
                            </table>
                        {% else %}
                            No match
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}

    <script>
        function updateCount(textareaId, countId) {
            const textarea = document.getElementById(textareaId);
            const countSpan = document.getElementById(countId);
            const lineCount = textarea.value.split('\n').filter(line => line.trim() !== '').length;
            countSpan.textContent = lineCount;
        }

        // Initialize counts on page load
        updateCount('dataset1', 'count1');
        updateCount('dataset2', 'count2');
    </script>
</body>
</html>
